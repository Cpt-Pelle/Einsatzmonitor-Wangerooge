<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dein Einsatzmonitor</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="leftSide">

        
        <div id="main-beach">
            <style type="text/css">
                .tg  {border-collapse:collapse;border-spacing:0;}
                .tg td{font-family:Arial, sans-serif;font-size:20px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                .tg th{font-family:Arial, sans-serif;font-size:20px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                .tg .tg-6eq8{color:#333333}
                .tg .tg-a0td{font-size:100%}
                </style>
                <table class="tg">
                  <tr>
                    <th class="tg-a0td" colspan="5"><div id="mainSwim-container" style="font-size: 20px;"> </div></th>
                  </tr>
                  <tr>
                    <td class="tg-031e" colspan="2">Schicht 1</td>
                    <td class="tg-6eq8" rowspan="4"></td>
                    <td class="tg-031e" colspan="2">Schicht 2</td>
                  </tr>
                  <tr>
                    <td class="tg-031e">Hauptstrand</td>
                    <td class="tg-031e">Oststrand</td>
                    <td class="tg-031e">Hauptstrand</td>
                    <td class="tg-031e">Oststrand</td>
                  </tr>
                  <tr>
                    <td class="tg-031e"><div id="shiftOneMainHelperOne" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftOneEastHelperOne" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftTwoMainHelperOne" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftTwoEastHelperOne" style="font-size: 15px;"> </div></td>
                  </tr>
                  <tr>
                    <td class="tg-031e"><div id="shiftOneMainHelperTwo" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftOneEastHelperTwo" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftTwoMainHelperTwo" style="font-size: 15px;"> </div></td>
                    <td class="tg-031e"><div id="shiftTwoEastHelperTwo" style="font-size: 15px;"> </div></td>
                  </tr>
                </table>
                
            
        </div>
        <div id="west-beach">

        </div>
    </div>

    <div id="topSide">

        <div id="weather">
            <a class="weatherwidget-io" href="https://forecast7.com/en/53d797d90/wangerooge/" data-label_1="WANGEROOGE" data-label_2="WEATHER" data-icons="Climacons Animated" data-mode="Current" data-days="3" data-theme="original" >WANGEROOGE WEATHER</a>
            <script>
                !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
            </script>
        </div>

        <div id="clock" style="text-align:center;padding:1em 0;"> 
            <iframe src="https://www.zeitverschiebung.net/clock-widget-iframe-v2?language=de&size=large&timezone=Europe%2FBerlin" width="100%" height="140" frameborder="0" seamless></iframe> 
            <small style="color:gray;">&copy; <a href="https://www.zeitzonenrechner.net/" style="color: gray;">Zeitzonenrechner</a></small> 
        </div>

        <div id="logo">
            <img src="static/langLogo.jpg" height="76" width="230">
        </div>
    
    </div>
    <div id="middle">
        <div id="livecam"></div>
        <script>

window.onload = function() {
  var iframe = document.createElement("iframe");
  iframe.src = "https://player.livespotting.tv/jwp.html?alias=PS_ea834";
  iframe.style.width = "100%";
  iframe.style.height = "100%";
  document.getElementById("livecam").appendChild(iframe);

  // Nachricht an das iframe senden, um das Video zu starten
  setTimeout(function() {
      iframe.contentWindow.postMessage('play', '*');
  }, 5000); // Verzögerung von 5 Sekunden
}

// Nachricht vom iframe empfangen
window.addEventListener('message', function(event) {
  // Hier kannst du auf Nachrichten vom iframe reagieren, falls nötig
}, false);

window.addEventListener('message', function(event) {
    // Wenn die Nachricht "play" ist, starte das Video
    console.log("Nachricht empfangen:", event.data);
    if (event.data === 'play') {
        var video = document.querySelector('video');
        if (video) {
            video.play();
        }
    }
}, false);
        </script>
        
        <div id="windBoard">
            <div
            data-windywidget="map"
            data-thememode="white"
            data-spotid="648315"
            data-appid="widgets_c8f474f16f">
            </div>
            <script async="true" data-cfasync="false" type="text/javascript" src="https://windy.app/widget3/windy_map_async.js?v289"></script>
        </div>
        

        <div id="windfinder">
            <div id="windfinder">
                <script src="https://de.windfinder.com/widget/forecast/js/wangerooge?unit_wave=m&unit_rain=mm&unit_temperature=c&unit_wind=m_s&unit_pressure=hPa&days=2&show_day=1"></script>
                <noscript>
                    <a rel="nofollow" href="https://www.windfinder.com/forecast/wangerooge?utm_source=forecast&utm_medium=web&utm_campaign=homepageweather&utm_content=noscript-forecast">Wind forecast for Wangerooge</a>
                    provided by <a rel="nofollow" href="https://www.windfinder.com?utm_source=forecast&utm_medium=web&utm_campaign=homepageweather&utm_content=noscript-logo">windfinder.com</a>
                </noscript>
            </div>
        
            <script>
                function updateWindfinder() {
                    // Entferne den gesamten Inhalt des Div-Containers
                    var windfinderDiv = document.getElementById('windfinder');
                    windfinderDiv.innerHTML = '';
        
                    // Füge das neue Skript hinzu
                    var newScript = document.createElement('script');
                    newScript.src = "https://de.windfinder.com/widget/forecast/js/wangerooge?unit_wave=m&unit_rain=mm&unit_temperature=c&unit_wind=m_s&unit_pressure=hPa&days=2&show_day=1";
                    windfinderDiv.appendChild(newScript);
        
                    // Füge noscript-Inhalt hinzu
                    var noscriptContent = '<noscript><a rel="nofollow" href="https://www.windfinder.com/forecast/wangerooge?utm_source=forecast&utm_medium=web&utm_campaign=homepageweather&utm_content=noscript-forecast">Wind forecast for Wangerooge</a> provided by <a rel="nofollow" href="https://www.windfinder.com?utm_source=forecast&utm_medium=web&utm_campaign=homepageweather&utm_content=noscript-logo">windfinder.com</a></noscript>';
                    windfinderDiv.insertAdjacentHTML('beforeend', noscriptContent);
                }
        
                // Aktualisiere alle 10 Minuten (600.000 Millisekunden)
                setInterval(updateWindfinder, 600000);
        
                // Initiales Laden beim Start
                updateWindfinder();
            </script>   
        </div>
    </div>


    <script type="text/javascript" src="stream.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <script>
        function updateDivContents() {


    // Funktion zum Einlesen der Excel-Datei und Aktualisieren der divs
    function readExcelFile(data) {
        var workbook = XLSX.read(data, { type: 'binary' });
        var sheetName = workbook.SheetNames[0];
        var sheet = workbook.Sheets[sheetName];

        // Zellenwert in das HTML-Div einfügen
        const today = new Date(Date.now())
        const day = today.getDate() + 2;
        const dayString = day.toString();
        const west = sheet['C2'].v + ": " + sheet['C' + dayString].v;

        const mainSwim = sheet['C2'].v + ": " + sheet['C' + dayString].v;
        document.getElementById('mainSwim-container').innerHTML = ' ' + mainSwim;

    }

    // Daten aus localStorage abrufen und aktualisieren
    var storedData = localStorage.getItem('excelData');
    if (storedData) {
        readExcelFile(storedData);
    }
            var mainShift1Helper1 = localStorage.getItem('mainShift1Helper1');
            var mainShift1Helper2 = localStorage.getItem('mainShift1Helper2');
            console.log(mainShift1Helper2);

            var mainShift2Helper1 = localStorage.getItem('mainShift2Helper1');
            var mainShift2Helper2 = localStorage.getItem('mainShift2Helper2');

            var eastShift1Helper1 = localStorage.getItem('eastShift1Helper1');
            var eastShift1Helper2 = localStorage.getItem('eastShift1Helper2');

            var eastShift2Helper1 = localStorage.getItem('eastShift2Helper1');
            var eastShift2Helper2 = localStorage.getItem('eastShift2Helper2');

            var westHelper1 = localStorage.getItem('westHelper1');
            var westHelper2 = localStorage.getItem('westHelper2');


            /**
            localStorage.setItem('mainShift1Helper1', mainShift1Helper1);
            localStorage.setItem('mainShift1Helper2', mainShift1Helper2);

            localStorage.setItem('mainShift2Helper1', mainShift2Helper1);
            localStorage.setItem('mainShift2Helper2', mainShift2Helper2);

            localStorage.setItem('westHelper1', westHelper1);
            localStorage.setItem('westHelper2', westHelper2);
            
            **/

            document.getElementById('shiftOneMainHelperOne').innerHTML = mainShift1Helper1;
            document.getElementById('shiftOneMainHelperTwo').innerHTML = mainShift1Helper2;

            document.getElementById('shiftTwoMainHelperOne').innerHTML = mainShift2Helper1;
            document.getElementById('shiftTwoMainHelperTwo').innerHTML = mainShift2Helper2;


            document.getElementById('shiftOneEastHelperOne').innerHTML = eastShift1Helper1;
            document.getElementById('shiftOneEastHelperTwo').innerHTML = eastShift1Helper2;

            document.getElementById('shiftTwoEastHelperOne').innerHTML = eastShift2Helper1;
            document.getElementById('shiftTwoEastHelperTwo').innerHTML = eastShift2Helper2;


            
}

setInterval(updateDivContents, 20000);


    </script>
    
     
</html>
